from torch.utils.data import Dataset
import numpy as np

class MalDataset(Dataset):
    def __init__(self, fp_list, first_n_byte=2000000):
        self.fp_list = fp_list
        self.first_n_byte = first_n_byte

    def __len__(self):
        return len(self.fp_list)
    
    def __getitem__(self, idx):
      with open(self.fp_list[idx][0],'rb') as f:
        tmp = [i for i in f.read()[:self.first_n_byte]]
        tmp = tmp+[256]*(self.first_n_byte-len(tmp)) # 256 is the value of the padding bytes
      return np.array(tmp),np.array(np.float32([self.fp_list[idx][1]]))