import numpy as np
import tarfile

def load_forest_dataset(dataset_path,first_n_byte,set):
    file_list=list()
    label_list=list()
    with tarfile.open(dataset_path,'r') as tar:
        for file in tar.getmembers():
            if file.isfile():
                name_splitted=file.name.split('/')
                train_or_test=name_splitted[-3]
                malware_type=name_splitted[-2]
                if set==train_or_test:
                    file_extracted = tar.extractfile(file)
                    tmp = [i for i in file_extracted.read()[:first_n_byte]]
                    tmp = tmp+[256]*(first_n_byte-len(tmp))
                    file_list.append(tmp)
                    label_list.append(malware_type)
    return file_list, label_list

    